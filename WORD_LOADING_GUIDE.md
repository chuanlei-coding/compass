# Microsoft Word 加载插件详细指南

本指南将详细说明如何在Microsoft Word中加载Word/WPS AI助手插件。

## 为什么看不到"上传我的加载项"？

这是一个常见问题，可能的原因包括：

1. **Word版本差异** - 不同版本的Word界面可能不同
2. **企业版限制** - 企业版Word可能有策略限制此功能
3. **权限设置** - 某些安全设置可能禁用了此选项
4. **界面变化** - Microsoft在不同版本中调整了界面

**解决方案**：使用侧载方式（下文方法1），这是最可靠的方法。

## 方法1：侧载方式（强烈推荐用于开发）

这是最可靠的方法，适用于所有Word版本（Word 2016+、Office 365等）。

### 步骤1：配置受信任的加载项目录

1. 打开Microsoft Word
2. 点击 **文件** > **选项**
3. 在左侧菜单中选择 **信任中心**
4. 点击 **信任中心设置** 按钮
5. 在左侧菜单中选择 **受信任的加载项目录**
6. 点击 **添加新位置** 按钮
7. 在弹出的对话框中：
   - 浏览到项目根目录（包含manifest.xml的文件夹）
   - 或者直接输入路径，例如：`C:\Users\YourName\code\compass`
   - 点击 **确定**
8. 在信任中心设置对话框中点击 **确定**
9. 在Word选项中点击 **确定**

### 步骤2：重启Word

1. **完全关闭Word**
   - 关闭所有Word窗口
   - 确保Word进程完全退出（可以检查任务管理器）

2. **重新打开Word**

### 步骤3：加载插件

1. 打开或创建一个Word文档
2. 点击顶部菜单栏的 **插入** 选项卡
3. 在"加载项"组中，点击 **我的加载项** 图标
   - 图标可能显示为"加载项"或一个拼图块图标
4. 在弹出的"Office加载项"对话框中：
   - 点击顶部的 **共享文件夹** 选项卡
   - 您应该能看到 **Word/WPS AI助手** 插件
   - 点击插件右侧的 **添加** 按钮
5. 插件将添加到Word中

### 步骤4：使用插件

1. 插件加载后，在 **插入** 选项卡的"加载项"组中会看到插件按钮
2. 或者在 **开始** 选项卡中会看到 **AI助手** 组和 **打开AI助手** 按钮
3. 点击按钮打开侧边栏

## 方法2：通过"上传我的加载项"（如果可用）

某些Word版本可能提供此选项：

### 步骤1：打开加载项对话框

1. 打开Microsoft Word
2. 点击 **插入** 选项卡
3. 点击 **我的加载项** 图标

### 步骤2：查找上传选项

在"Office加载项"对话框中，查找以下任一选项：
- **上传我的加载项**（中文版）
- **Upload My Add-in**（英文版）
- **从文件安装**
- 可能在不同位置：
  - 对话框顶部
  - 对话框底部
  - 右上角的菜单图标中

### 步骤3：上传插件

1. 如果找到了上传选项，点击它
2. 浏览到项目根目录
3. 选择 `manifest.xml` 文件
4. 点击 **上传** 或 **打开**
5. 插件将被加载

### 如果找不到上传选项

如果找不到"上传我的加载项"选项，这是正常的。请使用**方法1（侧载方式）**。

## 方法3：使用命令行工具（高级）

如果您熟悉命令行，可以使用Office Add-in CLI工具：

```bash
# 安装Office Add-in CLI（如果还没有）
npm install -g office-addin-dev-certs office-addin-manifest

# 侧载插件
npx office-addin-manifest validate manifest.xml
```

但最简单的方法仍然是方法1。

## 验证插件是否加载成功

### 检查方法1：功能区检查

1. 查看 **插入** 选项卡
2. 在"加载项"组中应该能看到插件图标
3. 或者在 **开始** 选项卡中看到 **AI助手** 组

### 检查方法2：我的加载项对话框

1. 点击 **插入** > **我的加载项**
2. 在 **已安装** 或 **我的加载项** 选项卡中
3. 应该能看到 **Word/WPS AI助手** 插件

### 检查方法3：侧边栏检查

1. 点击插件按钮（如果在功能区中）
2. 右侧应该出现侧边栏
3. 侧边栏标题应显示 "Word/WPS AI助手"
4. 标题栏右侧应显示当前平台（Microsoft Word）

## 常见问题解决

### 问题1：在"共享文件夹"中看不到插件

**可能原因和解决方案：**

1. **路径配置错误**
   - 检查信任中心设置中的路径是否正确
   - 确保路径指向包含manifest.xml的文件夹
   - 路径应该是文件夹路径，不是文件路径

2. **未重启Word**
   - 必须完全关闭并重新打开Word
   - 确保Word进程完全退出

3. **manifest.xml有问题**
   - 检查manifest.xml文件是否存在
   - 检查manifest.xml格式是否正确
   - 可以使用验证工具：`npm run validate`

### 问题2：插件加载但无法使用

**检查步骤：**

1. 确保开发服务器正在运行
   - 运行：`npm run dev`
   - 检查 `https://localhost:3000` 是否可以访问

2. 检查证书
   - 在浏览器中访问 `https://localhost:3000/taskpane.html`
   - 如果看到证书警告，接受证书

3. 查看错误信息
   - 在Word中，右键点击插件按钮
   - 选择"显示加载项"或"调试"
   - 查看错误信息

### 问题3：企业版Word的限制

如果使用企业版Word：

1. 可能需要管理员权限
2. 可能需要IT部门配置策略
3. 联系IT管理员启用侧载功能

### 问题4：插件按钮不显示

**解决方案：**

1. 检查插件是否已加载
   - 打开"我的加载项"对话框
   - 查看插件是否在列表中

2. 尝试重新加载
   - 在"我的加载项"中移除插件
   - 重新添加插件

3. 检查Word版本
   - 确保使用Word 2016或更高版本
   - Office 365版本最佳

## 不同Word版本的差异

### Word 2016
- 支持Office.js插件
- 使用侧载方式加载
- 可能没有"上传我的加载项"选项

### Word 2019 / Office 365
- 更好的插件支持
- 可能有"上传我的加载项"选项
- 推荐使用此版本

### Word Online
- 支持Office.js插件
- 需要通过Office Store或侧载方式

## 调试技巧

### 1. 使用开发者工具

1. 在Word中按 **F12**（如果可用）
2. 或者右键点击插件按钮，选择"调试"
3. 查看控制台错误信息

### 2. 检查网络请求

1. 打开开发者工具
2. 查看 **Network** 标签页
3. 检查是否有失败的请求
4. 确认 `https://localhost:3000` 可以访问

### 3. 验证manifest.xml

运行验证命令：
```bash
npm run validate
```

### 4. 查看Word日志

某些情况下，Word会生成日志文件，可以查看日志了解错误信息。

## 总结

**推荐方法：侧载方式（方法1）**

这是最可靠的方法，适用于所有Word版本：

1. ✅ 配置受信任的加载项目录
2. ✅ 重启Word
3. ✅ 在"共享文件夹"中加载插件

如果遇到任何问题，请参考 [TROUBLESHOOTING.md](TROUBLESHOOTING.md) 获取更多帮助。

