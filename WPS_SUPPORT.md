# WPS Office 支持说明

本插件已适配WPS Office，可以在Microsoft Word和WPS Office中运行。

## WPS兼容性

### 支持的WPS版本

- WPS Office 2019及以上版本
- 需要支持Office.js API的WPS版本
- WPS Writer（文字处理）

### 兼容性说明

1. **API兼容性**
   - WPS Office支持大部分Office.js API
   - 插件会自动检测运行环境（Word或WPS）
   - 使用相同的Office.js API，无需修改代码

2. **功能支持**
   - ✅ 文档内容读取
   - ✅ 文本插入
   - ✅ 文本替换
   - ✅ 文本格式化（加粗、斜体、下划线等）
   - ✅ 文本删除
   - ✅ 段落添加

3. **已知限制**
   - 某些高级API可能在WPS中不完全支持
   - 如果遇到API兼容性问题，插件会显示错误提示
   - 建议在WPS中测试所有功能

## 在WPS中加载插件

### 方法1：通过WPS加载项管理器

1. 打开WPS Writer
2. 点击"开发工具"选项卡
3. 选择"加载项" > "添加加载项"
4. 浏览并选择项目根目录下的 `manifest.xml` 文件
5. 点击"确定"加载插件

### 方法2：通过侧载方式

1. 打开WPS Writer
2. 转到"文件" > "选项" > "信任中心" > "信任中心设置"
3. 选择"受信任的加载项目录"
4. 添加包含 `manifest.xml` 的文件夹路径
5. 重启WPS
6. 在"开发工具" > "加载项"中找到插件并启用

## 平台检测

插件会自动检测运行环境：

- **Microsoft Word**: 显示"Microsoft Word"
- **WPS Office**: 显示"WPS Office"
- **未知平台**: 显示"未知平台"

检测逻辑位于 `src/taskpane/utils/PlatformDetector.ts`

## 故障排除

### WPS中插件无法加载

1. **检查WPS版本**
   - 确保使用WPS Office 2019或更高版本
   - 较旧版本可能不支持Office.js

2. **检查manifest.xml**
   - 确保URL指向正确的服务器地址
   - 确保使用HTTPS（WPS要求）

3. **检查证书**
   - WPS也需要HTTPS证书
   - 如果使用自签名证书，需要在WPS中接受证书

4. **查看控制台**
   - 在WPS中按F12打开开发者工具
   - 查看控制台错误信息

### API调用失败

如果某些功能在WPS中不工作：

1. 检查浏览器控制台的错误信息
2. 确认WPS版本支持该API
3. 某些API在WPS中可能返回不同的结果
4. 可以尝试使用更基础的API替代

## 测试建议

在WPS中测试以下功能：

- [ ] 插件能够正常加载
- [ ] 侧边栏能够正常显示
- [ ] 能够读取文档内容
- [ ] 能够插入文本
- [ ] 能够替换文本
- [ ] 能够格式化文本
- [ ] 能够删除文本
- [ ] AI功能正常工作

## 开发注意事项

1. **API兼容性测试**
   - 在Word和WPS中都进行测试
   - 注意API返回值的差异

2. **错误处理**
   - 添加适当的错误处理
   - 提供友好的错误提示

3. **平台特定功能**
   - 避免使用平台特定的API
   - 使用标准的Office.js API

## 反馈

如果发现WPS兼容性问题，请：
1. 记录WPS版本号
2. 记录错误信息
3. 提交Issue到项目仓库

